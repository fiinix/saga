<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<title>Saga</title>
	<meta name="description" content="">
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	
	<link href='http://fonts.googleapis.com/css?family=Inconsolata' rel='stylesheet' type='text/css'>
	
<style>

	*,
	*::before,
	*::after {

		box-sizing: border-box;

	}
	
	body {

		/* 030917 */
		/* 000418, 000410, 000208 */

		background-color: #000418;
		color: #ccc;

		font: normal 400 1.25em/1.4 'Inconsolata';

	}

	.day-mode {

		background-color: #eee;
		color: #222;

	}

	.counter {

		padding: 0.5em 1em 5em 5em;

		position: fixed;
		top: 0;
		right: 0;

		font-size: 0.7em;

		opacity: 0.5;

		cursor: pointer;

	}

	.editor {

		width: 100%;
		min-height: 100vh;
		/*height: 100%;*/
		max-width: 34em;
		margin: 4.5em auto;

		word-wrap: break-word;

		cursor: text;

		position: relative;
		
		outline: 0;

	}
	
	.editor:focus {
		
		outline: 0;
		
	}

	p { margin: 0; }
	p + p { margin-top: 1em; }

</style>

</head>
<body>

	<div class="counter">
		
	</div>

	<div class="editor" contenteditable><p>Hello Dave...</p></div>
	<!-- <div class="editor">
	<textarea class="editor" name="editor" id="editor" cols="30" rows="10">Hello Dave...</textarea>
	</div> -->

<script src="http://ajax.googleapis.com/ajax/libs/jquery/2.1.0/jquery.min.js"></script>
<script>
$(function() {

	var now = new Date(),
		currentHour = now.getHours(),
		body = $('body'),
		editor = $('.editor'),
		counter = $('.counter');

	if (currentHour >= 6 && currentHour <= 18)
		body.addClass('day-mode');

	function wordCount() {
		var content_div = editor,
		content_text,
		char_count = content_div.text().length,
		word_count = 0;

		// if no characters, words = 0
		if (char_count != 0)
		content_div.children().each(function(index, el) {
		content_text += $(el).text()+"\n";
		});
		// if there is content, splits the text at spaces (else displays 0 words)

		if (typeof content_text !== "undefined")
		word_count = content_text.split(/\s+/).length -1;
		// words_count = content_text.trim().replace(/\s+/, ' ').split(' ').length;
		counter.html(word_count + " words &nbsp;&bull;&nbsp; " + char_count + " characters");
	}

	wordCount();

	counter.click(function() {
		body.toggleClass('day-mode');
	});

	// paste sort of doesn't work because it can't count child elements without containers. I don't care for now.
	editor.on('keyup propertychange paste', function(){ 
		wordCount();
	});

});
</script>

</body>
</html>
